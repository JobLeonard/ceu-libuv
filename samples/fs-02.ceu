#include "c.ceu"
#include "uv.ceu"

var char[] path = [].."fs-01.txt";
var UV_FS_open o = UV_FS_open.build(&path, _O_RDONLY, 0);
await o.ok;
_assert(o.fd >= 0);

var int offset = 0;
loop do
    var byte[1024] buf;
    var int n = do UV_FS_read.run(&o,&buf,$$buf-1,offset);
    _assert(n >= 0);
    $buf := n+1;
    buf[n] = '\0';
    _printf("%s", (_char&&)(_byte&&)&&buf);
    if n == 0 then
        break;
    else
        offset = offset + ($$buf-1);
    end
end

escape 0;
